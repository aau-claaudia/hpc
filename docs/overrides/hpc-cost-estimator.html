{% extends "main.html" %}

{% block header %}
<header class="md-header md-header--shadow" data-md-component="header"></header>
{% endblock %}

{% block tabs %}{% endblock %}

{% block container %}
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
<link rel="stylesheet" href="../stylesheets/hpc-cost-estimator.css">
<script src="../assets/fonts.js"></script>

<div style="height: 100%; margin-top: 1rem;">
  <div class="estimator-header">
    <h1>HPC Cost Estimator</h1>
    <a href="#" class="d-inline-block" data-bs-toggle="tooltip" data-bs-placement="right"
      data-bs-title="This tool helps you estimate HPC resource usage and approximate costs.">
      <i class="bi bi-info-circle"></i>
    </a>
  </div>

  <div style="display: flex; gap: 32px; margin-bottom: 36px; min-height: inherit;">
    <!-- LEFT COLUMN -->
    <div style="flex: 1; padding-bottom: 24px; position: relative; width: 640px;">
      <div class="accordion shadow-sm" id="accordionExample">

        <!-- PROJECT DURATION -->
        <div class="accordion-item">
          <h2 class="accordion-header" id="headingDuration">
            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseDuration"
              aria-expanded="true" aria-controls="collapseDuration">
              Project duration
            </button>
          </h2>
          <div id="collapseDuration" class="accordion-collapse collapse show" data-bs-parent="#accordionExample">
            <div class="accordion-body">
              <div class="accordion-element">
                <div class="item-description">
                  <h4>What is the expected duration of your project?</h4>
                  <a href="#" class="d-inline-block" data-bs-toggle="tooltip" data-bs-placement="right"
                    data-bs-title="Use this input to set the duration you expect your project to last.">
                    <i class="bi bi-info-circle"></i>
                  </a>
                </div>
                <div class="input-group mb-3 mt-3">
                  <input type="number" class="form-control" id="durationMonthsInput" placeholder="0">
                  <span class="input-group-text">month(s)</span>
                  <input type="number" class="form-control" id="durationYearsInput" placeholder="0">
                  <span class="input-group-text">year(s)</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- STORAGE -->
        <div class="accordion-item">
          <h2 class="accordion-header" id="headingStorage">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
              data-bs-target="#collapseStorage" aria-expanded="false" aria-controls="collapseStorage">
              Storage
            </button>
          </h2>
          <div id="collapseStorage" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
            <div class="accordion-body">
              <div class="accordion-element">
                <div class="item-description">
                  <h4>What is the estimated data storage requirement?</h4>
                  <a href="#" class="d-inline-block" data-bs-toggle="tooltip" data-bs-placement="right"
                    data-bs-title="Enter the total storage in TB or GB you expect to need. If unsure, include a small buffer for growth or intermediate data. Backup of all transferred data is included in the price.">
                    <i class="bi bi-info-circle"></i>
                  </a>
                </div>
                <div class="input-group mb-3 mt-3">
                  <span class="input-group-text">Total amount of storage</span>
                  <input style="flex-basis: content;" type="number" class="form-control" id="storageInput" aria-label="storage" placeholder="0">
                  <select class="form-select" id="storageUnitSelect">
                    <option value="GB">GB</option>
                    <option value="TB" selected>TB</option>
                  </select>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- FRONTEND -->
        <div class="accordion-item">
          <h2 class="accordion-header" id="headingFrontend">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
              data-bs-target="#collapseFrontend" aria-expanded="false" aria-controls="collapseFrontend">
              Front-end computer
            </button>
          </h2>
          <div id="collapseFrontend" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
            <div class="accordion-body">
              <div class="accordion-element">
                <div class="item-description">
                  <h4>Specify the configuration for your interactive front-end computer</h4>
                  <a href="#" class="d-inline-block" data-bs-toggle="tooltip" data-bs-placement="right"
                    data-bs-title="The front-end computer is used to manage jobs, run setup scripts, handle data transfers, and provide an interactive environment before submitting tasks to the main compute resources.">
                    <i class="bi bi-info-circle"></i>
                  </a>
                </div>
                <div class="input-group mb-3 mt-3">
                  <label class="input-group-text" style="min-width: 85px;" for="frontEndSelect" id="frontEndSelectLabel">Default</label>
                  <select class="form-select" id="frontEndSelect">
                    <option value="default-frontend" selected>2 CPUs, 4 GB memory</option>
                    <option value="medium-frontend">4 CPUs, 8 GB memory</option>
                    <option value="large-frontend">8 CPUs, 16 GB memory</option>
                  </select>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- COMPUTE -->
        <div class="accordion-item">
          <h2 class="accordion-header" id="headingCompute">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
              data-bs-target="#collapseCompute" aria-expanded="false" aria-controls="collapseCompute">
              Compute
            </button>
          </h2>
          <div id="collapseCompute" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
            <div class="accordion-body">

              <div class="accordion-element">

                <!-- The dropdown button remains the same -->
                <div class="dropdown">
                  <button type="button" class="btn btn-outline-primary dropdown-toggle quiz-btn" data-bs-toggle="dropdown" aria-expanded="false" data-bs-auto-close="outside">
                    Quiz: Need help finding the right compute power?
                  </button>

                  <!-- Multi-step form wizard -->
                  <form class="dropdown-menu p-4 shadow" id="quizForm" style="width: 100%;">

                    <!-- STEP 1: PROJECT TYPE -->
                    <div id="quizStep1" style="display: block;">
                      <div class="mb-3">
                        <label class="form-label d-block quiz-title">Which best describes your research project?</label>
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionProjectType" id="projType1" value="ml-ai">
                          <label class="form-check-label" for="projType1">
                            Machine learning / Deep learning / AI
                          </label>
                        </div>
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionProjectType" id="projType2" value="data-analysis">
                          <label class="form-check-label" for="projType2">
                            Large-scale data analysis (big dataset queries, analytics)
                          </label>
                        </div>
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionProjectType" id="projType3" value="simulations">
                          <label class="form-check-label" for="projType3">
                            Scientific HPC simulations (CFD, genomics, physics, etc.)
                          </label>
                        </div>
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionProjectType" id="projType4" value="general">
                          <label class="form-check-label" for="projType4">
                            General-purpose computing (scripts, moderate calculations)
                          </label>
                        </div>
                      </div>
                      <button type="button" class="btn btn-primary" id="btnNext1">Next</button>
                    </div>

                    <!-- STEP 2: DATA SIZE -->
                    <div id="quizStep2" style="display: none;">
                      <div class="mb-3">
                        <label class="form-label d-block quiz-title">How large is your dataset in total?</label>
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionDataSize" id="dataSizeSmall" value="small">
                          <label class="form-check-label" for="dataSizeSmall">Small (under 1 TB)</label>
                        </div>
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionDataSize" id="dataSizeMedium" value="medium">
                          <label class="form-check-label" for="dataSizeMedium">Medium (1-10 TB)</label>
                        </div>
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionDataSize" id="dataSizeLarge" value="large">
                          <label class="form-check-label" for="dataSizeLarge">Large (10-100 TB)</label>
                        </div>
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionDataSize" id="dataSizeMassive" value="massive">
                          <label class="form-check-label" for="dataSizeMassive">Massive (100+ TB)</label>
                        </div>
                        <!-- Not sure -->
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionDataSize" id="dataSizeUnknown" value="dontknow">
                          <label class="form-check-label" for="dataSizeUnknown">Not sure</label>
                        </div>
                      </div>
                      <button type="button" class="btn btn-secondary me-2" id="btnPrev2">Back</button>
                      <button type="button" class="btn btn-primary" id="btnNext2">Next</button>
                    </div>

                    <!-- STEP 3: JOB LENGTH -->
                    <div id="quizStep3" style="display: none;">
                      <div class="mb-3">
                        <label class="form-label d-block quiz-title">How long do your typical jobs run?</label>
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionJobLength" id="jobShort" value="short">
                          <label class="form-check-label" for="jobShort">Short (minutes to a few hours)</label>
                        </div>
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionJobLength" id="jobMedium" value="medium">
                          <label class="form-check-label" for="jobMedium">Medium (~ half a day)</label>
                        </div>
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionJobLength" id="jobLong" value="long">
                          <label class="form-check-label" for="jobLong">Long (multi-day or continuous)</label>
                        </div>
                        <!-- Not sure -->
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionJobLength" id="jobUnknown" value="dontknow">
                          <label class="form-check-label" for="jobUnknown">Not sure</label>
                        </div>
                      </div>
                      <button type="button" class="btn btn-secondary me-2" id="btnPrev3">Back</button>
                      <button type="button" class="btn btn-primary" id="btnNext3">Next</button>
                    </div>

                    <!-- STEP 4: GPU USAGE -->
                    <div id="quizStep4" style="display: none;">
                      <div class="mb-3">
                        <label class="form-label d-block quiz-title">Do you plan to utilize GPUs (e.g., for deep learning)?</label>
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionGpuNeeded" id="gpuYes" value="yes">
                          <label class="form-check-label" for="gpuYes">Yes, GPU acceleration needed</label>
                        </div>
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionGpuNeeded" id="gpuNo" value="no">
                          <label class="form-check-label" for="gpuNo">No, CPU-only is sufficient</label>
                        </div>
                        <!-- Not sure -->
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionGpuNeeded" id="gpuUnknown" value="dontknow">
                          <label class="form-check-label" for="gpuUnknown">Not sure</label>
                        </div>
                      </div>
                      <button type="button" class="btn btn-secondary me-2" id="btnPrev4">Back</button>
                      <button type="button" class="btn btn-primary" id="btnNext4">Next</button>
                    </div>

                    <!-- STEP 5: PARALLELISM -->
                    <div id="quizStep5" style="display: none;">
                      <div class="mb-3">
                        <label class="form-label d-block quiz-title">Will you run tasks in parallel across multiple machines?</label>
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionConcurrency" id="concYes" value="yes">
                          <label class="form-check-label" for="concYes">Yes (MPI/distributed tasks or multiple concurrent jobs)</label>
                        </div>
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionConcurrency" id="concNo" value="no">
                          <label class="form-check-label" for="concNo">No, just a single machine</label>
                        </div>
                        <!-- Not sure -->
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionConcurrency" id="concUnknown" value="dontknow">
                          <label class="form-check-label" for="concUnknown">Not sure</label>
                        </div>
                      </div>
                      <button type="button" class="btn btn-secondary me-2" id="btnPrev5">Back</button>
                      <button type="button" class="btn btn-primary" id="btnNext5">Next</button>
                    </div>

                    <!-- STEP 6: REAL-TIME OR BATCH -->
                    <div id="quizStep6" style="display: none;">
                      <div class="mb-3">
                        <label class="form-label d-block quiz-title">Do you need interactive or near real-time processing?</label>
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionRealTime" id="realTimeYes" value="yes">
                          <label class="form-check-label" for="realTimeYes">Yes, quick turnarounds or interactive sessions</label>
                        </div>
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionRealTime" id="realTimeNo" value="no">
                          <label class="form-check-label" for="realTimeNo">No, offline/batch processing is fine</label>
                        </div>
                        <!-- Not sure -->
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionRealTime" id="realTimeUnknown" value="dontknow">
                          <label class="form-check-label" for="realTimeUnknown">Not sure</label>
                        </div>
                      </div>
                      <button type="button" class="btn btn-secondary me-2" id="btnPrev6">Back</button>
                      <button type="button" class="btn btn-primary" id="btnNext6">Next</button>
                    </div>

                    <!-- STEP 7: CONCURRENT USERS -->
                    <div id="quizStep7" style="display: none;">
                      <div class="mb-3">
                        <label class="form-label d-block quiz-title">How many users will be using this HPC at the same time?</label>
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionConcurrentUsers" id="oneUser" value="1">
                          <label class="form-check-label" for="oneUser">Just me (1 user)</label>
                        </div>
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionConcurrentUsers" id="smallTeam" value="small">
                          <label class="form-check-label" for="smallTeam">Small team (2-5 people)</label>
                        </div>
                        <div class="form-check custom-check">
                          <input class="form-check-input" type="radio" name="questionConcurrentUsers" id="largeTeam" value="large">
                          <label class="form-check-label" for="largeTeam">Large group (6+ people)</label>
                        </div>
                      </div>
                      <button type="button" class="btn btn-secondary me-2" id="btnPrev7">Back</button>
                      <button type="button" class="btn btn-primary" id="btnNext7">Next</button>
                    </div>

                    <!-- STEP 8: DAILY USAGE HOURS -->
                    <div id="quizStep8" style="display: none;">
                      <div class="mb-3">
                        <label class="form-label fw-bold" for="quizComputeHours">Approx. how many hours per day do you plan to run tasks?</label>
                        <input type="number" class="form-control" id="quizComputeHours" placeholder="e.g. 8" min="0">
                      </div>
                      <button type="button" class="btn btn-secondary me-2" id="btnPrev8">Back</button>
                      <button type="button" class="btn btn-primary" id="btnShowSummary">Next</button>
                    </div>

                    <!-- FINAL STEP: SUMMARY & ACTION -->
                    <div id="quizSummary" style="display: none;">
                      <h5 class="fw-bold mb-2">Recommended HPC Configuration</h5>
                      <p id="quizSummaryText" class="mb-3" style="white-space: pre-line;">
                        <!-- We'll fill this text via JavaScript -->
                      </p>
                      <button type="button" class="btn btn-secondary me-2" id="btnCancelQuiz">Cancel</button>
                      <button type="button" class="btn btn-primary" id="applyQuizBtn">Apply Settings</button>
                    </div>

                  </form>
                </div>
                <div class="item-title" style="margin-bottom: 5px;">
                  <div>
                    <h3>Configure your compute requirements</h3>
                  </div>
                </div>
              </div>

              <!-- vCPUs -->
              <div class="accordion-element">
                <div class="input-group mb-3">
                  <span class="input-group-text first">
                    Number of CPUs
                    <a href="#" class="d-inline-block" data-bs-toggle="tooltip" data-bs-placement="right"
                      data-bs-title="vCPUs (virtual CPUs) represent how many CPU cores your tasks can run on simultaneously. More vCPUs can speed up processing, but also increase cost.">
                      <i class="bi bi-info-circle"></i>
                    </a>
                  </span>
                  <input type="number" class="form-control" id="cpuInput" placeholder="0">
                </div>
              </div>
              
              <!-- Memory -->
              <div class="accordion-element">
                <div class="input-group mb-3">
                  <span class="input-group-text first">
                    Amount of memory (GB)
                    <a href="#" class="d-inline-block" data-bs-toggle="tooltip" data-bs-placement="right"
                      data-bs-title="Memory (RAM) is used to store data while it's being processed. Larger computations and datasets generally need more memory.">
                      <i class="bi bi-info-circle"></i>
                    </a>
                  </span>
                  <input type="number" class="form-control" id="memoryInput" placeholder="0">
                </div>
              </div>

              <!-- GPUs -->
              <div class="accordion-element">
                <div class="input-group mb-3">
                  <span class="input-group-text first">
                    Number of GPUs
                    <a href="#" class="d-inline-block" data-bs-toggle="tooltip" data-bs-placement="right"
                      data-bs-title="GPUs (Graphics Processing Units) can significantly accelerate specialized tasks (like deep learning). Only useful if your software supports GPU acceleration.">
                      <i class="bi bi-info-circle"></i>
                    </a>
                  </span>
                  <input type="number" class="form-control" id="gpuInput" placeholder="0">
                </div>
              </div>

              <!-- Number of Machines -->
              <div class="accordion-element">
                <div class="input-group mb-3">
                  <span class="input-group-text first">
                    Number of Machines
                    <a href="#" class="d-inline-block" data-bs-toggle="tooltip" data-bs-placement="right"
                      data-bs-title="This is how many HPC nodes (servers) you plan to run. Each node has its own CPU, memory, and optional GPUs. Increasing nodes can speed up parallel tasks.">
                      <i class="bi bi-info-circle"></i>
                    </a>
                  </span>
                  <input type="number" class="form-control" id="machinesInput" placeholder="0">
                </div>
              </div>

              <!-- Compute usage time -->
              <div class="accordion-element">
                <div class="input-group mb-3">
                  <span class="input-group-text first">
                    Total compute usage time
                    <a href="#" class="d-inline-block" data-bs-toggle="tooltip" data-bs-placement="right"
                      data-bs-title="Estimate how many hours the resources (CPUs/GPUs) will be actively running. For instance, 2 machines running 8 hours per day for 30 days = 480 machine-hours.">
                      <i class="bi bi-info-circle"></i>
                    </a>
                  </span>
                  <input type="number" class="form-control" id="computeHoursInput" placeholder="0">
                  <span class="input-group-text">hours</span>
                  <select class="form-select" id="computeHoursSelect">
                    <option value="per day" selected>per day</option>
                    <option value="per week">per week</option>
                    <option value="per month">per month</option>
                    <option value="in total">in total</option>
                  </select>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- DATA MANAGEMENT -->
        <div class="accordion-item">
          <h2 class="accordion-header" id="headingDataManagement">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
              data-bs-target="#collapseDataManagement" aria-expanded="false" aria-controls="collapseDataManagement">
              Data management
            </button>
          </h2>
          <div id="collapseDataManagement" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
            <div class="accordion-body">
              <div class="accordion-element">
                <div class="item-description">
                  <h4>Do you require help from data stewards?</h4>
                  <a href="#" class="d-inline-block" data-bs-toggle="tooltip" data-bs-placement="right"
                    data-bs-title="If you need specialized assistance with data organization, cleaning, or compliance, estimate the number of hours of support needed.">
                    <i class="bi bi-info-circle"></i>
                  </a>
                </div>
                <div class="input-group mb-3 mt-3">
                  <input type="number" class="form-control" id="dataMgmtHoursInput" placeholder="0">
                  <span class="input-group-text">hours</span>
                  <select class="form-select" id="dataMgmtHoursSelect">
                    <option value="per day" selected>per day</option>
                    <option value="per week">per week</option>
                    <option value="per month">per month</option>
                    <option value="in total">in total</option>
                  </select>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div> <!-- /accordion -->
    </div>

    <!-- RIGHT COLUMN (COST DETAILS) -->
    <div style="flex: 0 0 380px; min-height: inherit;">
      <div class="cost shadow-sm">
        <div class="cost-details">
          <div class="cost-header">
            <div class="cost-header-element">
              <div class="dropdown">
                <button type="button" class="btn btn-outline-primary dropdown-toggle pricelist-btn" data-bs-toggle="dropdown" aria-expanded="false" data-bs-auto-close="outside">
                  Pricelist
                </button>

                <!-- Multi-step form wizard -->
                <form class="dropdown-menu p-4 shadow" style="width: 350px;;">
                  <div>
                    <label class="quiz-title">Prices</label>
                    <p class="price-list-txt">- Storage: <span id="storagePrice"></span>/TB/year</p>
                    <p class="price-list-txt">- CPU: <span id="cpuPrice"></span>/CPU/hour</p>
                    <p class="price-list-txt">- Memory: <span id="memoryPrice"></span>/GB/hour</p>
                    <p class="price-list-txt">- GPU: <span id="gpuPrice"></span>/GPU/hour</p>
                    <p class="price-list-txt">- Data steward: <span id="stewardPrice"></span>/hour</p>
                    <a target="_blank" class="quiz-btn" style="color: rgb(13, 110, 253) !important;" href="https://genome.au.dk/pricing/">Prices are taken from GenomeDK</a>
                  </div>
                </form>
              </div>
            </div>
            <div class="cost-header-element">
              <i class="bi bi-filetype-pdf"></i>
              <span class="print-txt" id="print-btn">Print to pdf</span>
            </div>
          </div>
          <div class="cost-details-title">
            <h2>Cost details</h2>
            <select class="form-select" id="currencySelect" aria-label="Default select example" style="max-width: 100px;">
              <option value="DKK" selected>DKK</option>
              <option value="EUR">EUR</option>
            </select>
          </div>
          <hr class="price-divider">
          <div class="price-elements">
            <!-- STORAGE COST DISPLAY -->
            <div class="price-element">
              <div class="price-content">
                <div class="price-text">Storage</div>
                <div class="price-value" id="storageCostDisplay"></div>
              </div>
            </div>

            <!-- FRONT-END COST DISPLAY -->
            <div class="price-element">
              <div class="price-content">
                <div class="price-text">Front-end</div>
                <div class="price-value" id="frontEndCostDisplay"></div>
              </div>
            </div>

            <!-- COMPUTE COST DISPLAY -->
            <div class="price-element">
              <div class="price-content">
                <div class="price-text">Compute</div>
                <div class="price-value" id="computeCostDisplay"></div>
              </div>
            </div>

            <!-- DATA MANAGEMENT COST DISPLAY -->
            <div class="price-element">
              <div class="price-content">
                <div class="price-text">Data management</div>
                <div class="price-value" id="dataMgmtCostDisplay"></div>
              </div>
            </div>
          </div>

          
          <!-- TOTAL COST DISPLAY -->
          <hr class="price-divider">
          <div class="cost-total">
            <div class="cost-total-text">
              <div style="color: rgb(32, 33, 36) !important; text-transform: uppercase;" class="price-text">Total</div>
              <div style="color: rgb(32, 33, 36) !important;" class="price-value" id="totalCostDisplay"></div>
            </div>
          </div>
        </div>
      </div>
    </div> <!-- /Right column -->
  </div>

  <div>
    <hr style="margin: 16px 0; margin: 24px 0;">
    <h3 class="contact-claaudia-box">
      <i class="bi bi-chat-dots-fill" style="margin-right: 8px;"></i>
      If you need any assistance or have any questions, please contact
      <a target="_blank" href="https://serviceportal.aau.dk/serviceportal?id=emp_taxonomy_topic&topic_id=82a253e8838fc21053711d447daad328" class="contact-claaudia-link">CLAAUDIA</a>
    </h3>
  </div>

</div>


<script > 
  document.addEventListener("DOMContentLoaded", function() {
    // Initialize Bootstrap tooltips
    const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]');
    [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl));

    document.getElementById("print-btn").addEventListener("click", () => {
      
      
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      // Register fonts from window.customFonts
      Object.entries(window.customFonts).forEach(([name, data]) => {
          doc.addFileToVFS(`${name}.ttf`, data);
          doc.addFont(`${name}.ttf`, name, "normal");
      });


      let yOffset = 10;

      function addSection(title, sum, elements) {
        // Title (Bold)
        doc.setFontSize(10);
        doc.setFont("Roboto-SemiBold", "normal");
        doc.setFillColor(228, 230, 233);
        doc.rect(10, yOffset - 5, 190, 8, "F");
        doc.text(title, 15, yOffset);
        doc.text(sum, 195, yOffset, { align: "right" });
        yOffset += 8;

        elements.forEach(({ label, value, price }, index) => {
            if (index % 2 !== 0) {
                doc.setFillColor(242, 242, 244); // Light gray background for odd rows
                doc.rect(10, yOffset - 5, 190, 8, "F");
            }

            // Label (Regular or Thin)
            doc.setFontSize(8);
            doc.setFont("Roboto-Regular", "normal"); // Set font for label
            doc.text(`${label}:`, 15, yOffset);

            // Value (Light)
            doc.setFont("Roboto-Light", "normal");
            doc.text(value, 60, yOffset);

            // Price (Align right)
            if (price) {
                doc.setFont("Roboto-Regular", "normal"); // Use Regular for prices
                doc.text(price, 195, yOffset, { align: "right" });
            }

            yOffset += 8;
        });

        yOffset += 5;
      }

      const sections = [
        {
            title: "Storage",
            sum: summaryStorageSumValue, // Use the new variable
            elements: [
                { label: "Total amount of storage", value: summaryStorageAmountValue, price: summaryStoragePriceValue },
                { label: "Backup on initial data upload", value: "Yes", price: "N/A" },
                { label: "Compliance standards", value: "EU Region, ISO 27001/27002, GDPR", price: "N/A" }
            ]
        },
        {
            title: "Front-end computer",
            sum: summaryFrontendSumValue,
            elements: [
                { label: "Machine type", value: summaryFrontendTypeValue, price: summaryFrontendPriceValue },
                { label: "Number of machines", value: "1 machine", price: "N/A" },
                { label: "Instance-time", value: summaryFrontendTimeValue, price: "N/A" },
                { label: "Location type", value: "EU Region", price: "N/A" },
                { label: "Compliance standards", value: "EU Region, ISO 27001/27002, GDPR", price: "N/A" }
            ]
        },
        {
            title: "Compute",
            sum: summaryComputeSumValue,
            elements: [
                { label: "Number of instances", value: summaryComputeInstancesValue, price: "N/A" },
                { label: "Total amount of CPUs", value: summaryComputeCPUAmountValue, price: summaryComputeCPUPriceValue },
                { label: "Total amount of memory", value: summaryComputeMemorymountValue, price: summaryComputeMemoryPriceValue },
                { label: "Total amount of GPUs", value: summaryComputeGPUAmountValue, price: summaryComputeGPUPriceValue },
                { label: "Total compute usage time", value: summaryComputeUsageValue, price: "N/A" },
                { label: "Compliance standards", value: "EU Region, ISO 27001/27002, GDPR", price: "N/A" }
            ]
        },
        {
            title: "Data management",
            sum: summaryDMSumValue,
            elements: [
                { label: "Total amount of hours", value: summaryDMAmountValue, price: summaryDMPriceValue }
            ]
        }
    ];


      sections.forEach(section => addSection(section.title, section.sum, section.elements));

      // Total Price Box
      doc.setFillColor(228, 230, 233);
      doc.rect(10, yOffset, 190, 10, "F");
      doc.setFontSize(14);
      doc.setFont("Roboto-Bold", "normal");
      doc.text("Total estimated cost:", 15, yOffset + 7);
      doc.text(summaryTotalPriceValue, 195, yOffset + 7, { align: "right" });

      // Save PDF
      doc.save("hpc-cost-estimation-summary.pdf");
    });

    // Grab references
    const durationMonthsInput = document.getElementById("durationMonthsInput");
    const durationYearsInput = document.getElementById("durationYearsInput");

    const storageInput = document.getElementById("storageInput");
    const storageUnitSelect = document.getElementById("storageUnitSelect");

    const frontEndSelect = document.getElementById("frontEndSelect");
    const frontEndSelectLabel = document.getElementById("frontEndSelectLabel");

    const cpuInput = document.getElementById("cpuInput");
    const memoryInput = document.getElementById("memoryInput");
    const gpuInput = document.getElementById("gpuInput");

    const machinesInput = document.getElementById("machinesInput");
    const computeHoursInput = document.getElementById("computeHoursInput");
    const computeHoursSelect = document.getElementById("computeHoursSelect");

    const dataMgmtHoursInput = document.getElementById("dataMgmtHoursInput");
    const dataMgmtHoursSelect = document.getElementById("dataMgmtHoursSelect");

    const storageCostDisplay = document.getElementById("storageCostDisplay");
    const frontEndCostDisplay = document.getElementById("frontEndCostDisplay");
    const computeCostDisplay = document.getElementById("computeCostDisplay");
    const dataMgmtCostDisplay = document.getElementById("dataMgmtCostDisplay");
    const totalCostDisplay = document.getElementById("totalCostDisplay");

    const storagePrice = document.getElementById("storagePrice");
    const cpuPrice = document.getElementById("cpuPrice");
    const memoryPrice = document.getElementById("memoryPrice");
    const gpuPrice = document.getElementById("gpuPrice");
    const stewardPrice = document.getElementById("stewardPrice");

    const currencySelect = document.getElementById("currencySelect");

    let summaryStorageSumValue = "";
    let summaryStorageAmountValue = "";
    let summaryStoragePriceValue = "";

    let summaryFrontendSumValue = "";
    let summaryFrontendTypeValue = "";
    let summaryFrontendPriceValue = "";
    let summaryFrontendTimeValue = "";

    let summaryComputeSumValue = "";
    let summaryComputeInstancesValue = "";
    let summaryComputeCPUAmountValue = "";
    let summaryComputeCPUPriceValue = "";
    let summaryComputeMemorymountValue = "";
    let summaryComputeMemoryPriceValue = "";
    let summaryComputeGPUAmountValue = "";
    let summaryComputeGPUPriceValue = "";
    let summaryComputeUsageValue = "";

    let summaryDMSumValue = "";
    let summaryDMAmountValue = "";
    let summaryDMPriceValue = "";

    let summaryTotalPriceValue = "";


    // Pricelist from NGC: https://www.ngc.dk/forskning-og-internationalt-samarbejde/ngc-forskerservice
    storageListedPrice = 750 // DKK/TB/year (backup included)
    cpuListedPrice = 0.12 // DKK/CPU/hour
    memoryListedPrice = 0.12/8 // DKK/GB/hour
    gpuListedPrice = 6.00 // DKK/GPU/hour
    datastewardListedPrice = 311.00 // DKK/hour

    // Constants
    const DKK_TO_EUR = 1 / 7.45;  // approximate

    // Format a numeric amount with commas and 2 decimals
    function formatNumber(num) {
      return Number(num).toLocaleString("en-US", {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
      });
    }

    // Convert cost in DKK to the chosen currency
    function formatCurrency(dkkAmount) {
      // Decide which currency is selected
      const currency = currencySelect.value;  // "DKK" or "EUR"

      // Convert from DKK to EUR if needed
      let amount = dkkAmount;
      if (currency === "EUR") {
        amount *= DKK_TO_EUR;
      }

      // Convert to a nice string with commas and 2 decimals
      const formattedNumber = Number(amount).toLocaleString("en-US", {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
      });

      // Append the correct currency label
      return currency === "DKK" 
        ? `kr.${formattedNumber}`
        : `€${formattedNumber}`;
    }

    // Convert user “hours” input to total hours based on day/week/month/total
    function computeTotalHours(userHours, periodSelect, durationMonths) {
      let hours = parseFloat(userHours) || 0;
      let months = parseFloat(durationMonths) || 0;

      switch (periodSelect) {
        case "per day":
          return months * 31 * hours;
        case "per week":
          return months * 4.3 * hours;
        case "per month":
          return months * hours;
        case "in total":
          return hours;
      }
      return 0;
    }

    // Update all cost displays
    function updateAllCosts() {
      // Project duration in months
      let durMonths = parseFloat(durationMonthsInput.value) || 0;
      let durYears = parseFloat(durationYearsInput.value) || 0;

      const durationMonths = durMonths + (durYears*12);

      // ----- STORAGE COST -----
      let storageAmount = parseFloat(storageInput.value) || 0;
      let storageCost = 0;
      let storageText = `${parseFloat(storageInput.value) || 0}`;

      if (storageUnitSelect.value === "TB") {
        storageCost = storageAmount * (storageListedPrice / 12) * durationMonths;
        storageText = storageText + " TB"
      } else {
        storageCost = storageAmount * ((storageListedPrice/1000) / 12) * durationMonths;
        storageText = storageText + " GB"
      }

      // ----- FRONT-END COST -----
      // default = (2 CPU * cpuListedPrice + 4 GB * memoryListedPrice) * 24h * 31d * months
      // medium = (4 CPU * cpuListedPrice + 8 GB * memoryListedPrice) * 24h * 31d * months
      // large = (8 CPU * cpuListedPrice + 16 GB * memoryListedPrice) * 24h * 31d * months
      let frontEndType = frontEndSelect.value;
      let frontEndCost = 0;
      let hoursPerMonth = 24 * 31; // continuous usage each month

      if (frontEndType === "default-frontend") {
        frontEndCost =
          (2 * cpuListedPrice * hoursPerMonth * durationMonths) +
          (4 * memoryListedPrice * hoursPerMonth * durationMonths);
          frontEndSelectLabel.textContent = "Default";
      } else if (frontEndType === "medium-frontend") {
        frontEndCost =
          (4 * cpuListedPrice * hoursPerMonth * durationMonths) +
          (8 * memoryListedPrice * hoursPerMonth * durationMonths);
          frontEndSelectLabel.textContent = "Medium";
      } else if (frontEndType === "large-frontend") {
        frontEndCost =
          (8 * cpuListedPrice * hoursPerMonth * durationMonths) +
          (16 * memoryListedPrice * hoursPerMonth * durationMonths);
          frontEndSelectLabel.textContent = "Large";
      }

      // ----- COMPUTE COST -----
      // ((vCPUs*cpuListedPrice) + (memory*memoryListedPrice) + (GPUs*gpuListedPrice)) * machines * totalHours
      let vcpus = parseFloat(cpuInput.value) || 0;
      let mem = parseFloat(memoryInput.value) || 0;
      let gpus = parseFloat(gpuInput.value) || 0;
      let machines = parseFloat(machinesInput.value) || 0;
      let totalComputeHours = computeTotalHours(computeHoursInput.value, computeHoursSelect.value, durationMonths);

      let computeUnitCost = (vcpus * cpuListedPrice) + (mem * memoryListedPrice) + (gpus * gpuListedPrice);
      let computeCost = computeUnitCost * machines * totalComputeHours;

      // ----- DATA MANAGEMENT COST -----
      // totalHours * (600000 / (160.33 * 12))
      let dataMgmtTotalHours = computeTotalHours(dataMgmtHoursInput.value, dataMgmtHoursSelect.value, durationMonths);
      let dataMgmtCost = dataMgmtTotalHours * datastewardListedPrice;

      // ----- SUM ALL COSTS IN DKK -----
      let totalCostDKK = storageCost + frontEndCost + computeCost + dataMgmtCost;

      // Update the individual displays in the correct currency
      storageCostDisplay.textContent = formatCurrency(storageCost);
      frontEndCostDisplay.textContent = formatCurrency(frontEndCost);
      computeCostDisplay.textContent = formatCurrency(computeCost);
      dataMgmtCostDisplay.textContent = formatCurrency(dataMgmtCost);
      totalCostDisplay.textContent = formatCurrency(totalCostDKK);

      storagePrice.textContent = formatCurrency(storageListedPrice);
      cpuPrice.textContent = formatCurrency(cpuListedPrice);
      memoryPrice.textContent = formatCurrency(memoryListedPrice);
      gpuPrice.textContent = formatCurrency(gpuListedPrice);
      stewardPrice.textContent = formatCurrency(datastewardListedPrice);
      
      summaryStorageSumValue = formatCurrency(storageCost);
      summaryStorageAmountValue = storageText;
      summaryStoragePriceValue = formatCurrency(storageCost);

      summaryFrontendSumValue = formatCurrency(frontEndCost);
      summaryFrontendTypeValue = frontEndSelect.options[frontEndSelect.selectedIndex].text;
      summaryFrontendPriceValue = formatCurrency(frontEndCost);
      const frontendHours = durationMonths * 31 * 24;
      summaryFrontendTimeValue = `${frontendHours.toLocaleString('da-DK')} hours`;

      summaryComputeSumValue = formatCurrency(computeCost);
      summaryComputeInstancesValue = `${machines} machines`;
      summaryComputeCPUAmountValue = `${vcpus} CPUs`;
      summaryComputeCPUPriceValue = formatCurrency(vcpus * cpuListedPrice * machines * totalComputeHours);
      summaryComputeMemorymountValue = `${mem} GB`;
      summaryComputeMemoryPriceValue = formatCurrency(mem * memoryListedPrice * machines * totalComputeHours);
      summaryComputeGPUAmountValue = `${gpus} GPUs`;
      summaryComputeGPUPriceValue = formatCurrency(gpus * gpuListedPrice * machines * totalComputeHours);
      summaryComputeUsageValue = `${totalComputeHours.toLocaleString('da-DK')} hours`;

      summaryDMSumValue = formatCurrency(dataMgmtCost);
      summaryDMAmountValue = `${dataMgmtTotalHours.toLocaleString('da-DK')} hours`;
      summaryDMPriceValue = formatCurrency(dataMgmtCost);

      summaryTotalPriceValue = formatCurrency(totalCostDKK);
    }

    // Set up event listeners

    // Project duration
    durationMonthsInput.addEventListener("input", updateAllCosts);
    durationYearsInput.addEventListener("input", updateAllCosts);

    // Storage
    storageInput.addEventListener("input", updateAllCosts);
    storageUnitSelect.addEventListener("change", updateAllCosts);

    // Front-end selection
    frontEndSelect.addEventListener("change", updateAllCosts);

    // Compute inputs
    cpuInput.addEventListener("input", updateAllCosts);
    memoryInput.addEventListener("input", updateAllCosts);
    gpuInput.addEventListener("input", updateAllCosts);

    // Machines, Compute hours & dropdown
    machinesInput.addEventListener("input", updateAllCosts);
    computeHoursInput.addEventListener("input", updateAllCosts);
    computeHoursSelect.addEventListener("change", updateAllCosts);

    // Data management
    dataMgmtHoursInput.addEventListener("input", updateAllCosts);
    dataMgmtHoursSelect.addEventListener("change", updateAllCosts);

    // Currency switch
    currencySelect.addEventListener("change", updateAllCosts);

    // Initialize everything on load
    updateAllCosts();

    ////////////////////////////////////////////////////////////////////////////////
    // MULTI-STEP QUIZ WIZARD
    ////////////////////////////////////////////////////////////////////////////////
    (function() {
      // We store user answers in a small object
      let answers = {
        projectType: null,      // question 1
        dataSize: null,         // question 2
        jobLength: null,        // question 3
        gpuNeeded: null,        // question 4
        concurrency: null,      // question 5
        realTimeNeeded: null,   // question 6
        concurrentUsers: null,  // question 7
        dailyHours: 0           // question 8
      };

      // STEP references
      const step1 = document.getElementById("quizStep1");
      const step2 = document.getElementById("quizStep2");
      const step3 = document.getElementById("quizStep3");
      const step4 = document.getElementById("quizStep4");
      const step5 = document.getElementById("quizStep5");
      const step6 = document.getElementById("quizStep6");
      const step7 = document.getElementById("quizStep7");
      const step8 = document.getElementById("quizStep8");
      const stepSummary = document.getElementById("quizSummary");

      // Buttons
      const btnNext1   = document.getElementById("btnNext1");
      const btnNext2   = document.getElementById("btnNext2");
      const btnPrev2   = document.getElementById("btnPrev2");
      const btnNext3   = document.getElementById("btnNext3");
      const btnPrev3   = document.getElementById("btnPrev3");
      const btnNext4   = document.getElementById("btnNext4");
      const btnPrev4   = document.getElementById("btnPrev4");
      const btnNext5   = document.getElementById("btnNext5");
      const btnPrev5   = document.getElementById("btnPrev5");
      const btnNext6   = document.getElementById("btnNext6");
      const btnPrev6   = document.getElementById("btnPrev6");
      const btnNext7   = document.getElementById("btnNext7");
      const btnPrev7   = document.getElementById("btnPrev7");
      const btnNext8   = document.getElementById("btnShowSummary");
      const btnPrev8   = document.getElementById("btnPrev8");

      const quizSummaryText = document.getElementById("quizSummaryText");
      const btnCancelQuiz   = document.getElementById("btnCancelQuiz");
      const btnApplyQuiz    = document.getElementById("applyQuizBtn");

      const quizComputeHours = document.getElementById("quizComputeHours");

      // A helper to get a radio value by name
      function getRadioValue(name) {
        const radios = document.getElementsByName(name);
        for (let i = 0; i < radios.length; i++) {
          if (radios[i].checked) return radios[i].value;
        }
        return null;
      }

      // A helper to show/hide steps
      function showStep(current, next) {
        current.style.display = "none";
        next.style.display    = "block";
      }

      //////////////////////////////////////////////////////////////////////////
      // STEP-BY-STEP NAVIGATION
      //////////////////////////////////////////////////////////////////////////

      // Step 1 -> Step 2
      btnNext1.addEventListener("click", function() {
        const val = getRadioValue("questionProjectType");
        if (!val) {
          alert("Please select an answer to continue.");
          return;
        }
        answers.projectType = val;
        showStep(step1, step2);
      });

      // Step 2 -> Next or Back
      btnNext2.addEventListener("click", function() {
        const val = getRadioValue("questionDataSize");
        if (!val) {
          alert("Please select an answer to continue.");
          return;
        }
        // If "dontknow", we default to "small"
        answers.dataSize = (val === "dontknow") ? "small" : val;
        showStep(step2, step3);
      });
      btnPrev2.addEventListener("click", function() {
        showStep(step2, step1);
      });

      // Step 3 -> Next or Back
      btnNext3.addEventListener("click", function() {
        const val = getRadioValue("questionJobLength");
        if (!val) {
          alert("Please select an answer to continue.");
          return;
        }
        // If "dontknow", default to "short"
        answers.jobLength = (val === "dontknow") ? "short" : val;
        showStep(step3, step4);
      });
      btnPrev3.addEventListener("click", function() {
        showStep(step3, step2);
      });

      // Step 4 -> Next or Back
      btnNext4.addEventListener("click", function() {
        const val = getRadioValue("questionGpuNeeded");
        if (!val) {
          alert("Please select an answer to continue.");
          return;
        }
        // If "dontknow", default to "no" (CPU-only)
        answers.gpuNeeded = (val === "dontknow") ? "no" : val;
        showStep(step4, step5);
      });
      btnPrev4.addEventListener("click", function() {
        showStep(step4, step3);
      });

      // Step 5 -> Next or Back
      btnNext5.addEventListener("click", function() {
        const val = getRadioValue("questionConcurrency");
        if (!val) {
          alert("Please select an answer to continue.");
          return;
        }
        // If "dontknow", default to "no" (single machine)
        answers.concurrency = (val === "dontknow") ? "no" : val;
        showStep(step5, step6);
      });
      btnPrev5.addEventListener("click", function() {
        showStep(step5, step4);
      });

      // Step 6 -> Next or Back
      btnNext6.addEventListener("click", function() {
        const val = getRadioValue("questionRealTime");
        if (!val) {
          alert("Please select an answer to continue.");
          return;
        }
        // If "dontknow", default to "yes" (interactive)
        answers.realTimeNeeded = (val === "dontknow") ? "yes" : val;
        showStep(step6, step7);
      });
      btnPrev6.addEventListener("click", function() {
        showStep(step6, step5);
      });

      // Step 7 -> Next or Back
      btnNext7.addEventListener("click", function() {
        const val = getRadioValue("questionConcurrentUsers");
        if (!val) {
          alert("Please select an answer to continue.");
          return;
        }
        answers.concurrentUsers = val;
        showStep(step7, step8);
      });
      btnPrev7.addEventListener("click", function() {
        showStep(step7, step6);
      });

      // Step 8 -> Show Summary or Back
      btnNext8.addEventListener("click", function() {
        // daily hours
        const dh = parseFloat(quizComputeHours.value) || 0;
        answers.dailyHours = dh;

        // Move to summary
        showStep(step8, stepSummary);

        // Now compute recommended HPC config so we can display it
        const { recommendedVCPUs, recommendedMemoryGB, recommendedGPUs, recommendedMachines } 
          = computeRecommendation(answers);

        // Fill the summary text
        const summary = 
          `For your project, we estimate:\n\n` +
          `- vCPUs: ${recommendedVCPUs}\n` +
          `- Memory (GB): ${recommendedMemoryGB}\n` +
          `- GPUs: ${recommendedGPUs}\n` +
          `- Number of machines: ${recommendedMachines}\n` +
          `- Daily usage hours: ${dh}\n\n` +
          `Click "Apply Settings" to use these values, or "Cancel" to discard.`;

        quizSummaryText.textContent = summary;
      });
      btnPrev8.addEventListener("click", function() {
        showStep(step8, step7);
      });

      // CANCEL
      btnCancelQuiz.addEventListener("click", function() {
        resetWizard();
      });

      // APPLY SETTINGS
      btnApplyQuiz.addEventListener("click", function() {
        // Actually set the HPC form
        const { recommendedVCPUs, recommendedMemoryGB, recommendedGPUs, recommendedMachines } 
          = computeRecommendation(answers);

        // 1) daily usage => "per day"
        computeHoursSelect.value = "per day";
        computeHoursInput.value  = answers.dailyHours.toString();

        // 2) Inputs
        cpuInput.value = recommendedVCPUs;
        memoryInput.value = recommendedMemoryGB;
        gpuInput.value = recommendedGPUs;

        machinesInput.value = recommendedMachines;

        // 3) Trigger cost update
        updateAllCosts();

        // For convenience, you might also close the dropdown:
        const quizForm = document.getElementById("quizForm");
        quizForm.classList.remove("show");

        resetWizard();
      });

      //////////////////////////////////////////////////////////////////////////
      // HPC RECOMMENDATION LOGIC
      //////////////////////////////////////////////////////////////////////////
      function computeRecommendation(a) {
        // a = { projectType, dataSize, jobLength, gpuNeeded, concurrency, realTimeNeeded, concurrentUsers, dailyHours }
        let recommendedVCPUs     = 4;
        let recommendedMemoryGB = 8;
        let recommendedGPUs      = 0;
        let recommendedMachines  = 1;

        // -- Project type
        switch (a.projectType) {
          case "ml-ai":
            recommendedVCPUs     = 8;
            recommendedMemoryGB = 32;
            break;
          case "data-analysis":
            recommendedVCPUs     = 8;
            recommendedMemoryGB = 16;
            break;
          case "simulations":
            recommendedVCPUs     = 16;
            recommendedMemoryGB = 64;
            break;
          case "general":
            recommendedVCPUs     = 4;
            recommendedMemoryGB = 8;
            break;
        }

        // -- Data size
        switch (a.dataSize) {
          case "medium":
            recommendedMemoryGB = Math.max(recommendedMemoryGB, 16);
            break;
          case "large":
            recommendedMemoryGB = Math.max(recommendedMemoryGB, 32);
            break;
          case "massive":
            recommendedMemoryGB = Math.max(recommendedMemoryGB, 64);
            break;
          // "small" => do nothing
        }

        // -- Job length
        if (a.jobLength === "medium") {
          recommendedVCPUs     = Math.max(recommendedVCPUs, 8);
          recommendedMemoryGB = Math.max(recommendedMemoryGB, 16);
        } else if (a.jobLength === "long") {
          recommendedVCPUs     = Math.max(recommendedVCPUs, 16);
          recommendedMemoryGB = Math.max(recommendedMemoryGB, 32);
        }
        // "short" => do nothing

        // -- GPU usage
        if (a.gpuNeeded === "yes") {
          recommendedGPUs = (a.projectType === "ml-ai") ? 2 : 1;
        }
        // "no" => do nothing

        // -- Parallelism
        if (a.concurrency === "yes") {
          if (a.projectType === "simulations") {
            recommendedMachines = 8;
          } else if (a.projectType === "data-analysis" || a.projectType === "ml-ai") {
            recommendedMachines = 4;
          } else {
            recommendedMachines = 2;
          }
        }
        // "no" => do nothing

        // -- Real-time
        if (a.realTimeNeeded === "yes") {
          recommendedVCPUs += 4;
        }
        // "no" => do nothing

        // -- Concurrent users
        if (a.concurrentUsers === "small") {
          recommendedMachines = Math.max(recommendedMachines, 2);
          recommendedVCPUs    = Math.max(recommendedVCPUs, 8);
        } else if (a.concurrentUsers === "large") {
          recommendedMachines  = Math.max(recommendedMachines, 4);
          recommendedVCPUs     = Math.max(recommendedVCPUs, 16);
          recommendedMemoryGB = Math.max(recommendedMemoryGB, 32);
        }
        // "1" => do nothing

        return { recommendedVCPUs, recommendedMemoryGB, recommendedGPUs, recommendedMachines };
      }

      function resetWizard() {
        // 1) Hide all steps
        step1.style.display      = "none";
        step2.style.display      = "none";
        step3.style.display      = "none";
        step4.style.display      = "none";
        step5.style.display      = "none";
        step6.style.display      = "none";
        step7.style.display      = "none";
        step8.style.display      = "none";
        stepSummary.style.display= "none";

        // 2) Show the first step again
        step1.style.display = "block";

        // 3) Clear all radio-button selections
        const radios = quizForm.querySelectorAll('input[type="radio"]');
        radios.forEach(radio => {
          radio.checked = false;
        });

        // 4) Clear daily hours
        quizComputeHours.value = "";

        // 5) Optionally close the dropdown:
        //    If you want to close the dropdown after Apply or Cancel, remove the "show" class:
        quizForm.classList.remove("show");

        // You could also reset your `answers` object if you keep it in a higher scope
        answers = {
          projectType: null,     
          dataSize: null,        
          jobLength: null,       
          gpuNeeded: null,       
          concurrency: null,     
          realTimeNeeded: null,  
          concurrentUsers: null, 
          dailyHours: 0          
        };
      }


    })();

  });

  
</script>
{% endblock %}